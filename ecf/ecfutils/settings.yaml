settings:
  Template: *settings_schema

  # Import certain variables from doc.parm_files:
  Inherit: !Inherit
    - [ 'doc.parm_files','FH.*|QUEUE|.*layout.*|.*WRITE_GROUP|.*WRT.*|HOME.*' ]

  # NOTE: Additional files are set by the validator.  See validator.yaml.

  resource_file: !expand >-
    resources/{doc.parm_files.CASE}_{doc.parm_files.CASE_ENKF}.yaml

  DMPDIR: !calc doc.parm_files.DMPDIR
  COM: !calc doc.parm_files.ROTDIR
  EXPDIR: !calc doc.parm_files.EXPDIR
  DATAROOT: !calc doc.parm_files.RUNDIR
  experiment_name: !calc doc.parm_files.PSLOT

  PROJECT: !calc ( doc.parm_files.ACCOUNT )
  QUEUESERV: !calc ( doc.parm_files.QUEUE_ARCH )

  ENKF_INNOVATE_GROUPS: !calc >-
    doc.parm_files.NMEM_ENKF // doc.parm_files.NMEM_EOMGGRP

  ENKF_FORECAST_GROUPS: !calc >-
    doc.parm_files.NMEM_ENKF // doc.parm_files.NMEM_EFCSGRP

  ENKF_ARCHIVE_GROUPS: !calc >-
    doc.parm_files.NMEM_ENKF // doc.parm_files.NMEM_EARCGRP

  start_date: !calc tools.strptime(doc.parm_files.SDATE,"%Y%m%d%H")
  end_date:  !calc tools.strptime(doc.parm_files.EDATE,"%Y%m%d%H")

  gfs_forecast_hours: !calc >-
    tools.uniq(sorted(
      tools.seq(FHMIN_GFS,FHMAX_HF_GFS,FHOUT_HF_GFS) +
      tools.seq(FHMIN_GFS,FHMAX_GFS,   FHOUT_GFS)))
  gdas_forecast_hours: !calc tools.seq(FHMIN,FHMAX,FHOUT)
  wafs_last_hour: !calc 120

  realtime: True
  archive_to_hpss: True
  four_cycle_mode: False
  ecflow_machine: xc40-prod

  fv3gfs_machine: !calc doc.parm_files.machine
